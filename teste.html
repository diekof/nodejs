<script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script>
    var html = `
    <p>DE: ANDERSON FIGUEREDO</p>
<p>PARA: JANDER</p>
<p>&nbsp;</p>
<p>ASSUNTO: TESTE DE HTMLTOPDF</p>
<p>&nbsp;</p>
<h2>R&uacute;ssia empacou em todas as frentes, diz Reino Unido</h2>
<p>O Minist&eacute;rio da Defesa do Reino Unido tem publicado relat&oacute;rios curtos di&aacute;rios sobre o estado da guerra na Ucr&acirc;nia. Nesta quinta-feira (17), as afirma&ccedil;&otilde;es s&atilde;o as seguintes:</p>
<ul class="ul-level-0">
<li>A invas&atilde;o da Ucr&acirc;nia pela R&uacute;ssia empacou em todas as frentes;</li>
<li>As for&ccedil;as russas fizeram progressos m&iacute;nimos em terra, no mar e no ar nos dias recentes e continuam a sofrer perdas significativas;</li>
<li>A resist&ecirc;ncia ucraniana continua firme e coordenada; a grande maioria do territ&oacute;rio ucraniano, incluindo as principais cidades, est&aacute; em m&atilde;os ucranianas.</li>
</ul>
<p>F&Eacute;RIAS J&Aacute; RECEBIDAS, s&oacute; retirando saldo restante:</p>
<p>&nbsp;</p>
<table width="739">
<tbody>
<tr>
<td width="278">
<p><strong>Servidor</strong></p>
</td>
<td width="133">
<p><strong>Matricula</strong></p>
</td>
<td width="133">
<p><strong>Per&iacute;odo Aquisitivo</strong></p>
</td>
<td width="133">
<p><strong>Gozo</strong></p>
</td>
<td width="61">
<p><strong>Saldo</strong></p>
</td>
</tr>
<tr>
<td width="278">
<p>3084 - Alex Silva Adriano</p>
</td>
<td width="133">
<p>TESTE</p>
</td>
<td width="133">
<p>25/03/19 a 24/03/20</p>
</td>
<td width="133">
<p>02/03/22 a 16/03/22</p>
</td>
<td width="61">
<p>Zera</p>
</td>
</tr>
<tr>
<td width="278">
<p>1539 - Claudemir Cantarin da Silva</p>
</td>
<td width="133">
<p>TESTE</p>
</td>
<td width="133">
<p>01/02/20 a 31/01/21</p>
</td>
<td width="133">
<p>16/03/22 a 30/03/22</p>
</td>
<td width="61">
<p>Zera</p>
</td>
</tr>
<tr>
<td width="278">
<p>2214 - Ivanice dos Santos Silva</p>
</td>
<td width="133">
<p>TESTE</p>
</td>
<td width="133">
<p>28/05/19 a 27/05/20</p>
</td>
<td width="133">
<p>07/02/22 a 15/02/22</p>
</td>
<td width="61">
<p>Zera</p>
</td>
</tr>
<tr>
<td width="278">
<p>2237 - Onemia Scarbi Crestani</p>
</td>
<td width="133">
<p>TESTE</p>
</td>
<td width="133">
<p>27/06/18 a 26/06/19</p>
</td>
<td width="133">
<p>02/03/22 a 16/03/22</p>
</td>
<td width="61">
<p>Zera</p>
</td>
</tr>
<tr>
<td width="278">
<p>1803 - Viviane Alves Dias Petry</p>
</td>
<td width="133">
<p>TESTE</p>
</td>
<td width="133">
<p>08/05/18 a 07/05/19</p>
</td>
<td width="133">
<p>07/02/22 a 13/02/22</p>
</td>
<td width="61">
<p>Zera</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>TERMO DE ANU&Ecirc;NCIA</p>
<p>&nbsp;</p>
<table width="754">
<tbody>
<tr>
<td width="284">
<p><strong>Servidor</strong></p>
</td>
<td width="136">
<p><strong>Matricula</strong></p>
</td>
<td width="136">
<p><strong>Per&iacute;odo Aquisitivo</strong></p>
</td>
<td width="135">
<p><strong>Gozo</strong></p>
</td>
<td width="62">
<p><strong>Saldo</strong></p>
</td>
</tr>
<tr>
<td width="284">
<p>2190 - Ione Borges Aguiar</p>
</td>
<td width="136">
<p>TESTE</p>
</td>
<td width="136">
<p>15/05/19 a 14/05/20</p>
</td>
<td width="135">
<p>24/01/22 a 07/02/22</p>
</td>
<td width="62">
<p>Zera</p>
</td>
</tr>
<tr>
<td width="284">
<p>0236 - M&aacute;rcia Geovana Stangherlin</p>
</td>
<td width="136">
<p>TESTE</p>
</td>
<td width="136">
<p>22/02/19 a 21/02/20</p>
</td>
<td width="135">
<p>17/01/22 a 23/01/22</p>
</td>
<td width="62">
<p>16 dias</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Sem mais para o momento.</p>
<p>Atenciosamente,</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<td width="300">
<table width="100%">
<tbody>
<tr>
<td>
<p><strong><em>DALMO HENRIQUE THOMAZZI</em></strong></p>
<p><strong><em>Secret&aacute;rio Municipal de Sa&uacute;de</em></strong></p>
<p><strong>Portaria 029/2021</strong></p>
<p>&nbsp;</p>
</td>
</tr>
</tbody>
</table>
&nbsp;</td>
</tr>
</tbody>
</table>
<p>Campo Novo do Parecis, 11 de fevereiro de 2022</p>
`;
    var json = {
        "nome_arquivo": "arquivo_656565656.pdf",
        "cabecalho": "cabecalho",
        "rodape": "rodape",
        "conteudo": html
    }
    function downloadPdf() {
        console.log('data');
        var file_name = 'funciona_trem.pdf';
        var ajaxUrl = "http://localhost:3000/convert/pdf";
        console.log(ajaxUrl);
        var ajax = new XMLHttpRequest();

        ajax.open("POST", ajaxUrl, true);
        ajax.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
        ajax.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        ajax.onreadystatechange = function () {
            if (this.readyState == 4) {
                if (this.status == 200) {

                    var blob = new Blob([this.response], { type: "application/octet-stream" });

                    var a = document.createElement('a');
                    var url = window.URL.createObjectURL(blob);
                    a.href = url;
                    a.download = 'myfile.pdf';
                    document.body.append(a);
                    a.click();
                    a.remove();
                    window.URL.revokeObjectURL(url);

                } else if (this.responseText != "") {
                    console.log(this.responseText);
                }
            } else if (this.readyState == 2) {
                if (this.status == 200) {
                    this.responseType = "blob";
                } else {
                    this.responseType = "text";
                }
            }
        };
        ajax.send(JSON.stringify(json));

    }

</script>
<button onclick="downloadPdf()">chama ms</button>